<Page
	x:Class="EPIC.Capture.Calibrate" xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation" xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml" xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" xmlns:d="http://schemas.microsoft.com/expression/blend/2008" xmlns:capture="clr-namespace:EPIC.Capture" xmlns:utilities="clr-namespace:EPIC.Utilities" xmlns:converters="clr-namespace:EPIC.Utilities.Converters" xmlns:entityClasses="clr-namespace:EPICClearViewDL.EntityClasses;assembly=EPICClearViewDL" xmlns:controls="clr-namespace:EPIC.Controls" xmlns:macros="clr-namespace:EPIC.Macros"
	Title="{x:Static Capture.Calibrate_Title}"
	SnapsToDevicePixels="True"
	UseLayoutRounding="True">
	<FrameworkElement.Resources>
		<ResourceDictionary>
			<ResourceDictionary.MergedDictionaries>
				<ResourceDictionary
					Source="/Themes/ClearView.xaml" />
			</ResourceDictionary.MergedDictionaries>
			<converters:DeviceSettingStringConverter
				x:Key="DeviceSettingStringConverter" />
			<BitmapImage
				UriSource="/Resources/1001-cancel.png"
				x:Key="Cancel" />
			<BitmapImage
				UriSource="/Resources/0186-refresh.png"
				x:Key="Cycle" />
			<BitmapImage
				UriSource="/Resources/0063-undo.png"
				x:Key="Reset" />
			<BitmapImage
				UriSource="/Resources/0005-time_edit.png"
				x:Key="AutoCalibrate" />
		</ResourceDictionary>
	</FrameworkElement.Resources>
	<ScrollViewer
		VerticalScrollBarVisibility="Auto"
		HorizontalScrollBarVisibility="Auto">
		<Grid
			HorizontalAlignment="Center"
			VerticalAlignment="Center">
			<Grid.ColumnDefinitions>
				<ColumnDefinition />
				<ColumnDefinition
					Width="Auto" />
				<ColumnDefinition />
			</Grid.ColumnDefinitions>
			<Grid.RowDefinitions>
				<RowDefinition
					Height="Auto" />
				<RowDefinition
					Height="Auto" />
				<RowDefinition
					Height="Auto" />
			</Grid.RowDefinitions>
			<StackPanel
				Grid.Column="0"
				Orientation="Vertical"
				HorizontalAlignment="Right">
				<Label
					Content="{x:Static capture:Capture.Calibrate_CapturedImage}"
					HorizontalAlignment="Center" />
				<Border
					BorderThickness="1"
					Margin="5">
					<FrameworkElement.Style>
						<Style>
							<Setter
								Property="BorderBrush"
								Value="{x:Null}" />
							<Style.Triggers>
								<DataTrigger
									Binding="{Binding ElementName=Capture, Path=Source}"
									Value="{x:Null}">
									<Setter
										Property="BorderBrush"
										Value="#FF000000" />
								</DataTrigger>
							</Style.Triggers>
						</Style>
					</FrameworkElement.Style>
					<Image
						Name="Capture"
						Height="240"
						Width="320" />
				</Border>
			</StackPanel>
			<GroupBox
				Grid.Column="1"
				Margin="5"
				Header="{x:Static capture:Capture.Calibrate_CalibrationSettings}"
				HorizontalAlignment="Center"
				VerticalAlignment="Center">
				<ListBox
					Name="Configurations"
					BorderThickness="0"
					Background="#00FFFFFF"
					ItemsSource="{Binding Source={x:Static utilities:ClearViewConfiguration.Current}, Path=Device.Settings}">
					<FrameworkElement.Resources>
						<ResourceDictionary>
							<Style
								TargetType="{x:Type ListBoxItem}"
								x:Key="{x:Type ListBoxItem}">
								<Setter
									Property="UIElement.SnapsToDevicePixels"
									Value="True" />
								<Setter
									Property="FrameworkElement.OverridesDefaultStyle"
									Value="True" />
								<Setter
									Property="ListBoxItem.IsSelected"
									Value="{Binding Mode=OneTime, Path=IsDefault}" />
								<Setter
									Property="Template">
									<Setter.Value>
										<ControlTemplate
											TargetType="{x:Type ListBoxItem}">
											<RadioButton
												Margin="5"
												GroupName="CalibrationSettings"
												IsChecked="{Binding Mode=TwoWay, Path=IsSelected, RelativeSource={RelativeSource TemplatedParent}}"
												Content="{Binding Converter={StaticResource DeviceSettingStringConverter}}" />
										</ControlTemplate>
									</Setter.Value>
								</Setter>
							</Style>
						</ResourceDictionary>
					</FrameworkElement.Resources>
				</ListBox>
			</GroupBox>
			<StackPanel
				Grid.Column="2"
				Orientation="Vertical"
				HorizontalAlignment="Left">
				<Label
					Content="{x:Static capture:Capture.Calibrate_ImagePreview}"
					HorizontalAlignment="Center" />
				<Border
					BorderThickness="1"
					Margin="5">
					<FrameworkElement.Style>
						<Style>
							<Setter
								Property="BorderBrush"
								Value="{x:Null}" />
							<Style.Triggers>
								<DataTrigger
									Binding="{Binding ElementName=Preview, Path=Source}"
									Value="{x:Null}">
									<Setter
										Property="BorderBrush"
										Value="#FF000000" />
								</DataTrigger>
							</Style.Triggers>
						</Style>
					</FrameworkElement.Style>
					<Image
						Name="Preview"
						Height="240"
						Width="320" />
				</Border>
			</StackPanel>
			<ScrollViewer
				Name="Scroller"
				Grid.Row="1"
				Grid.ColumnSpan="3"
				MinHeight="70"
				VerticalScrollBarVisibility="Hidden"
				MinWidth="800"
				HorizontalScrollBarVisibility="Auto"
				Width="{Binding Path=ViewportWidth, RelativeSource={RelativeSource FindAncestor, AncestorType=ScrollViewer}}"
				Style="{StaticResource ResourceKey=HorizontalScroller}">
				<StackPanel
					Name="CalibrationImages"
					Orientation="Horizontal"
					HorizontalAlignment="Center">
					<controls:CalibrationImage
						Finished="Calibration_Finished"
						MouseLeftButtonUp="Select_Image"
						MouseRightButtonUp="Load_Image"
						Margin="5" />
					<controls:CalibrationImage
						Finished="Calibration_Finished"
						MouseLeftButtonUp="Select_Image"
						MouseRightButtonUp="Load_Image"
						Margin="5" />
					<controls:CalibrationImage
						Finished="Calibration_Finished"
						MouseLeftButtonUp="Select_Image"
						MouseRightButtonUp="Load_Image"
						Margin="5" />
					<controls:CalibrationImage
						Finished="Calibration_Finished"
						MouseLeftButtonUp="Select_Image"
						MouseRightButtonUp="Load_Image"
						Margin="5" />
					<controls:CalibrationImage
						Finished="Calibration_Finished"
						MouseLeftButtonUp="Select_Image"
						MouseRightButtonUp="Load_Image"
						Margin="5" />
					<controls:CalibrationImage
						Finished="Calibration_Finished"
						MouseLeftButtonUp="Select_Image"
						MouseRightButtonUp="Load_Image"
						Margin="5" />
					<controls:CalibrationImage
						Finished="Calibration_Finished"
						MouseLeftButtonUp="Select_Image"
						MouseRightButtonUp="Load_Image"
						Margin="5" />
					<controls:CalibrationImage
						Finished="Calibration_Finished"
						MouseLeftButtonUp="Select_Image"
						MouseRightButtonUp="Load_Image"
						Margin="5" />
					<controls:CalibrationImage
						Finished="Calibration_Finished"
						MouseLeftButtonUp="Select_Image"
						MouseRightButtonUp="Load_Image"
						Margin="5" />
					<controls:CalibrationImage
						Finished="Calibration_Finished"
						MouseLeftButtonUp="Select_Image"
						MouseRightButtonUp="Load_Image"
						Margin="5" />
				</StackPanel>
			</ScrollViewer>
			<Grid
				Row="2"
				ColumnSpan="3">
				<Grid.ColumnDefinitions>
					<ColumnDefinition />
					<ColumnDefinition />
				</Grid.ColumnDefinitions>
				<ToggleButton
					Name="DutyCycle"
					HorizontalAlignment="Left"
					Margin="5"
					Padding="3"
					Checked="DutyCycle_Checked"
					Unchecked="DutyCycle_Checked">
					<StackPanel
						Orientation="Horizontal">
						<Image
							Source="{StaticResource Cycle}"
							Height="25"
							Width="25"
							Margin="3,0" />
						<TextBlock
							VerticalAlignment="Center"
							HorizontalAlignment="Center">
							<FrameworkElement.Style>
								<Style>
									<Setter
										Property="Text"
										Value="{x:Static capture:Capture.Calibrate_DutyCycle}" />
									<Style.Triggers>
										<DataTrigger
											Value="True"
											Binding="{Binding ElementName=DutyCycle, Path=IsChecked}">
											<Setter
												Property="Text"
												Value="{x:Static capture:Capture.Calibrate_StopDutyCycle}" />
										</DataTrigger>
									</Style.Triggers>
								</Style>
							</FrameworkElement.Style>
						</TextBlock>
					</StackPanel>
				</ToggleButton>
				<StackPanel
					Grid.Column="1"
					Orientation="Horizontal"
					HorizontalAlignment="Right">
					<Button
						Margin="5"
						Padding="3"
						Click="Reset_Click">
						<StackPanel
							Orientation="Horizontal">
							<Image
								Source="{StaticResource Reset}"
								Height="25"
								Width="25"
								Margin="3,0" />
							<TextBlock
								VerticalAlignment="Center"
								HorizontalAlignment="Center"
								Text="{x:Static capture:Capture.Calibrate_ResetImages}" />
						</StackPanel>
					</Button>
					<ToggleButton
						Name="AutoCalibrate"
						Margin="5"
						Padding="3"
						Checked="AutoCalibrate_Checked"
						Unchecked="AutoCalibrate_Checked">
						<StackPanel
							Orientation="Horizontal">
							<Image
								Source="{StaticResource AutoCalibrate}"
								Height="25"
								Width="25"
								Margin="3,0" />
							<TextBlock
								VerticalAlignment="Center"
								HorizontalAlignment="Center">
								<FrameworkElement.Style>
									<Style>
										<Setter
											Property="Text"
											Value="{x:Static capture:Capture.Calibrate_AutoCalibration}" />
										<Style.Triggers>
											<DataTrigger
												Value="True"
												Binding="{Binding ElementName=AutoCalibrate, Path=IsChecked}">
												<Setter
													Property="Text"
													Value="Cancel Calibration" />
											</DataTrigger>
										</Style.Triggers>
									</Style>
								</FrameworkElement.Style>
							</TextBlock>
						</StackPanel>
					</ToggleButton>
					<Button
						Margin="5"
						Padding="3"
						Command="{x:Static macros:Navigation.CloseTabCommand}"
						CommandParameter="{Binding RelativeSource={RelativeSource Mode=Self}}">
						<StackPanel
							Orientation="Horizontal">
							<Image
								Source="{StaticResource Cancel}"
								Height="25"
								Width="25"
								Margin="3,0" />
							<TextBlock
								VerticalAlignment="Center"
								HorizontalAlignment="Center"
								Text="{x:Static capture:Capture.Calibrate_Close}" />
						</StackPanel>
					</Button>
				</StackPanel>
			</Grid>
		</Grid>
	</ScrollViewer>
</Page>
