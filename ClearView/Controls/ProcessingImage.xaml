<UserControl
	x:Class="EPIC.Controls.ProcessingImage" xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation" xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml" xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" xmlns:d="http://schemas.microsoft.com/expression/blend/2008" xmlns:shaders="clr-namespace:EPIC.Utilities.Shaders"
	SnapsToDevicePixels="True"
	UseLayoutRounding="True"
	IsHitTestVisible="True"
	Height="60"
	Width="80"
	Background="#00FFFFFF"
	BorderThickness="1"
	Cursor="Hand" xmlns:controls="clr-namespace:EPIC.Controls"
	DataContext="{Binding RelativeSource={RelativeSource Self}}">
	<FrameworkElement.Style>
		<Style
			TargetType="{x:Type UserControl}">
			<Setter
				Property="BorderBrush"
				Value="#00FFFFFF" />
			<Style.Triggers>
				<DataTrigger
					Binding="{Binding Image}"
					Value="{x:Null}">
					<Setter
						Property="BorderBrush"
						Value="#FF000000" />
				</DataTrigger>
			</Style.Triggers>
		</Style>
	</FrameworkElement.Style>
	<Grid>
		<Image
			RenderOptions.BitmapScalingMode="HighQuality"
			Stretch="Fill"
			Source="{Binding Path=Image}" />
		<Grid
			Opacity=".7">
			<ProgressBar
				Name="Progress"
				Panel.ZIndex="1"
				VerticalAlignment="Bottom"
				Height="15"
				SnapsToDevicePixels="True"
				UseLayoutRounding="True">
				<FrameworkElement.Style>
					<Style
						TargetType="{x:Type ProgressBar}">
						<Setter
							Property="Visibility"
							Value="Visible" />
						<Setter
							Property="ProgressBar.IsIndeterminate"
							Value="True" />
						<Setter
							Property="Foreground"
							Value="#FF1E90FF" />
						<Setter
							Property="RangeBase.Value"
							Value="{Binding Path=Value}" />
						<Style.Triggers>
							<DataTrigger
								Value="{x:Null}"
								Binding="{Binding Image}">
								<Setter
									Property="Visibility"
									Value="Hidden" />
							</DataTrigger>
							<DataTrigger
								Value="Paused"
								Binding="{Binding State}">
								<Setter
									Property="Foreground"
									Value="#FFFFFF00" />
							</DataTrigger>
							<DataTrigger
								Value="Processing"
								Binding="{Binding State}">
								<Setter
									Property="ProgressBar.IsIndeterminate"
									Value="False" />
								<Setter
									Property="Foreground"
									Value="#FF01D328" />
							</DataTrigger>
							<MultiDataTrigger>
								<MultiDataTrigger.Conditions>
									<Condition
										Value="Processing"
										Binding="{Binding State}" />
									<Condition
										Value="0"
										Binding="{Binding Value}" />
								</MultiDataTrigger.Conditions>
								<Setter
									Property="ProgressBar.IsIndeterminate"
									Value="True" />
							</MultiDataTrigger>
							<DataTrigger
								Value="Failed"
								Binding="{Binding State}">
								<Setter
									Property="ProgressBar.IsIndeterminate"
									Value="False" />
								<Setter
									Property="Foreground"
									Value="#FFFF0000" />
								<Setter
									Property="RangeBase.Value"
									Value="100" />
							</DataTrigger>
							<DataTrigger
								Value="Complete"
								Binding="{Binding State}">
								<Setter
									Property="ProgressBar.IsIndeterminate"
									Value="False" />
								<Setter
									Property="RangeBase.Value"
									Value="100" />
							</DataTrigger>
						</Style.Triggers>
					</Style>
				</FrameworkElement.Style>
				<Control.Template>
					<ControlTemplate
						TargetType="{x:Type ProgressBar}">
						<Grid
							Name="TemplateRoot"
							SnapsToDevicePixels="True">
							<Rectangle
								Fill="{TemplateBinding Background}"
								RadiusY="2"
								RadiusX="2" />
							<Border
								CornerRadius="2"
								Margin="1">
								<Border.Background>
									<LinearGradientBrush
										EndPoint="0,1"
										StartPoint="0,0">
										<GradientStop
											Color="#50FFFFFF"
											Offset="0.5385" />
										<GradientStop
											Color="Transparent"
											Offset="0.5385" />
									</LinearGradientBrush>
								</Border.Background>
							</Border>
							<Border
								BorderBrush="#80FFFFFF"
								BorderThickness="1,0,1,1"
								Margin="1">
								<Border.Background>
									<LinearGradientBrush
										EndPoint="0,1"
										StartPoint="0,0">
										<GradientStop
											Color="#80FFFFFF"
											Offset="0.05" />
										<GradientStop
											Color="Transparent"
											Offset="0.25" />
									</LinearGradientBrush>
								</Border.Background>
							</Border>
							<Rectangle
								Name="PART_Track"
								Margin="1" />
							<Decorator
								Name="PART_Indicator"
								HorizontalAlignment="Left"
								Margin="1">
								<Grid
									Name="Foreground">
									<Rectangle
										Name="Indicator"
										Fill="{TemplateBinding Foreground}" />
									<Grid
										Name="Animation"
										ClipToBounds="True">
										<Rectangle
											Name="PART_GlowRect"
											HorizontalAlignment="Left"
											Margin="-100,0,0,0"
											Width="100">
											<Shape.Fill>
												<LinearGradientBrush
													EndPoint="1,0"
													StartPoint="0,0">
													<GradientStop
														Color="Transparent"
														Offset="0" />
													<GradientStop
														Color="#60FFFFFF"
														Offset="0.4" />
													<GradientStop
														Color="#60FFFFFF"
														Offset="0.6" />
													<GradientStop
														Color="Transparent"
														Offset="1" />
												</LinearGradientBrush>
											</Shape.Fill>
										</Rectangle>
									</Grid>
									<Grid
										Name="Overlay">
										<Grid.ColumnDefinitions>
											<ColumnDefinition
												MaxWidth="15" />
											<ColumnDefinition
												Width="0.1*" />
											<ColumnDefinition
												MaxWidth="15" />
										</Grid.ColumnDefinitions>
										<Grid.RowDefinitions>
											<RowDefinition />
											<RowDefinition />
										</Grid.RowDefinitions>
										<Rectangle
											Name="LeftDark"
											Margin="1,1,0,1"
											RadiusY="1"
											RadiusX="1"
											Grid.RowSpan="2">
											<Shape.Fill>
												<LinearGradientBrush
													EndPoint="1,0"
													StartPoint="0,0">
													<GradientStop
														Color="#0C000000"
														Offset="0" />
													<GradientStop
														Color="#20000000"
														Offset="0.3" />
													<GradientStop
														Color="#00000000"
														Offset="1" />
												</LinearGradientBrush>
											</Shape.Fill>
										</Rectangle>
										<Rectangle
											Name="RightDark"
											Grid.Column="2"
											Margin="0,1,1,1"
											RadiusY="1"
											RadiusX="1"
											Grid.RowSpan="2">
											<Shape.Fill>
												<LinearGradientBrush
													EndPoint="1,0"
													StartPoint="0,0">
													<GradientStop
														Color="#00000000"
														Offset="0" />
													<GradientStop
														Color="#20000000"
														Offset="0.7" />
													<GradientStop
														Color="#0C000000"
														Offset="1" />
												</LinearGradientBrush>
											</Shape.Fill>
										</Rectangle>
										<Rectangle
											Name="LeftLight"
											Grid.Column="0"
											Grid.Row="2">
											<Shape.Fill>
												<RadialGradientBrush
													RadiusY="1"
													RadiusX="1">
													<Brush.RelativeTransform>
														<MatrixTransform
															Matrix="1,0,0,1,0.5,0.5" />
													</Brush.RelativeTransform>
													<GradientStop
														Color="#60FFFFC4"
														Offset="0" />
													<GradientStop
														Color="#00FFFFC4"
														Offset="1" />
												</RadialGradientBrush>
											</Shape.Fill>
										</Rectangle>
										<Rectangle
											Name="CenterLight"
											Grid.Column="1"
											Grid.Row="2">
											<Shape.Fill>
												<LinearGradientBrush
													EndPoint="0,0"
													StartPoint="0,1">
													<GradientStop
														Color="#60FFFFC4"
														Offset="0" />
													<GradientStop
														Color="#00FFFFC4"
														Offset="1" />
												</LinearGradientBrush>
											</Shape.Fill>
										</Rectangle>
										<Rectangle
											Name="RightLight"
											Grid.Column="2"
											Grid.Row="2">
											<Shape.Fill>
												<RadialGradientBrush
													RadiusY="1"
													RadiusX="1">
													<Brush.RelativeTransform>
														<MatrixTransform
															Matrix="1,0,0,1,-0.5,0.5" />
													</Brush.RelativeTransform>
													<GradientStop
														Color="#60FFFFC4"
														Offset="0" />
													<GradientStop
														Color="#00FFFFC4"
														Offset="1" />
												</RadialGradientBrush>
											</Shape.Fill>
										</Rectangle>
										<Border
											Name="Highlight1"
											Grid.ColumnSpan="3"
											Grid.RowSpan="2">
											<Border.Background>
												<LinearGradientBrush
													EndPoint="0,1"
													StartPoint="0,0">
													<GradientStop
														Color="#90FFFFFF"
														Offset="0.5385" />
													<GradientStop
														Color="Transparent"
														Offset="0.5385" />
												</LinearGradientBrush>
											</Border.Background>
										</Border>
										<Border
											Name="Highlight2"
											Grid.ColumnSpan="3"
											Grid.RowSpan="2">
											<Border.Background>
												<LinearGradientBrush
													EndPoint="0,1"
													StartPoint="0,0">
													<GradientStop
														Color="#80FFFFFF"
														Offset="0.05" />
													<GradientStop
														Color="Transparent"
														Offset="0.25" />
												</LinearGradientBrush>
											</Border.Background>
										</Border>
									</Grid>
								</Grid>
							</Decorator>
							<Border
								BorderBrush="{TemplateBinding BorderBrush}"
								BorderThickness="{TemplateBinding BorderThickness}"
								CornerRadius="2" />
						</Grid>
						<ControlTemplate.Triggers>
							<Trigger
								Property="ProgressBar.Orientation"
								Value="Vertical">
								<Setter
									TargetName="TemplateRoot"
									Property="FrameworkElement.LayoutTransform">
									<Setter.Value>
										<RotateTransform
											Angle="-90" />
									</Setter.Value>
								</Setter>
							</Trigger>
							<Trigger
								Property="ProgressBar.IsIndeterminate"
								Value="True">
								<Setter
									TargetName="LeftDark"
									Property="Visibility"
									Value="Collapsed" />
								<Setter
									TargetName="RightDark"
									Property="Visibility"
									Value="Collapsed" />
								<Setter
									TargetName="LeftLight"
									Property="Visibility"
									Value="Collapsed" />
								<Setter
									TargetName="CenterLight"
									Property="Visibility"
									Value="Collapsed" />
								<Setter
									TargetName="RightLight"
									Property="Visibility"
									Value="Collapsed" />
								<Setter
									TargetName="Indicator"
									Property="Visibility"
									Value="Collapsed" />
							</Trigger>
							<Trigger
								Property="ProgressBar.IsIndeterminate"
								Value="False">
								<Setter
									TargetName="Animation"
									Property="Background"
									Value="#00000000" />
							</Trigger>
						</ControlTemplate.Triggers>
					</ControlTemplate>
				</Control.Template>
			</ProgressBar>
			<StackPanel
				Name="Inverse"
				ZIndex="0"
				VerticalAlignment="Bottom"
				Background="#FFFFFFFF"
				SnapsToDevicePixels="True"
				UseLayoutRounding="True"
				Height="{Binding ElementName=Progress, Path=ActualHeight}">
				<UIElement.Effect>
					<shaders:InvertColorEffect>
						<shaders:InvertColorEffect.Input>
							<VisualBrush
								Stretch="None"
								Visual="{Binding ElementName=Progress}" />
						</shaders:InvertColorEffect.Input>
					</shaders:InvertColorEffect>
				</UIElement.Effect>
			</StackPanel>
			<TextBlock
				Name="Status"
				Panel.ZIndex="2"
				HorizontalAlignment="Center"
				FontSize="10"
				VerticalAlignment="Bottom"
				FontWeight="Bold"
				Visibility="{Binding ElementName=Progress, Path=Visibility}"
				Height="{Binding ElementName=Progress, Path=ActualHeight}">
				<TextBlock.Foreground>
					<VisualBrush
						Stretch="None"
						Visual="{Binding ElementName=Inverse}" />
				</TextBlock.Foreground>
				<FrameworkElement.Style>
					<Style>
						<Setter
							Property="Text"
							Value="Queued..." />
						<Style.Triggers>
							<DataTrigger
								Value="Processing"
								Binding="{Binding State}">
								<Setter
									Property="Text"
									Value="Processing..." />
							</DataTrigger>
							<DataTrigger
								Value="Paused"
								Binding="{Binding State}">
								<Setter
									Property="Text"
									Value="Paused..." />
							</DataTrigger>
							<DataTrigger
								Value="Complete"
								Binding="{Binding State}">
								<Setter
									Property="Text"
									Value="Completed" />
							</DataTrigger>
							<DataTrigger
								Value="Failed"
								Binding="{Binding State}">
								<Setter
									Property="Text"
									Value="Failed" />
							</DataTrigger>
						</Style.Triggers>
					</Style>
				</FrameworkElement.Style>
			</TextBlock>
		</Grid>
	</Grid>
</UserControl>
