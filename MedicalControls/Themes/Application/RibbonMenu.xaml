<ResourceDictionary
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:classic="clr-namespace:Microsoft.Windows.Themes;assembly=PresentationFramework.Aero"
    xmlns:componentModel="clr-namespace:System.ComponentModel;assembly=PresentationFramework"
    xmlns:controls="clr-namespace:System.Windows.Controls;assembly=System.Windows.Controls.Ribbon"
    xmlns:entities="clr-namespace:EPIC.DataLayer.Entities;assembly=DataLayer"
    xmlns:primitives="clr-namespace:System.Windows.Controls.Ribbon.Primitives;assembly=System.Windows.Controls.Ribbon"
    xmlns:ribbon="clr-namespace:System.Windows.Controls.Ribbon;assembly=System.Windows.Controls.Ribbon"
    xmlns:shell="clr-namespace:System.Windows.Shell;assembly=PresentationFramework"
    xmlns:system="clr-namespace:System;assembly=mscorlib">
    <!--<ResourceDictionary.MergedDictionaries>
        <ResourceDictionary Source="pack://application:,,,/System.Windows.Controls.Ribbon;component/Themes/Generic.xaml" />
    </ResourceDictionary.MergedDictionaries>-->
    <BooleanToVisibilityConverter x:Key="BooleanToVisibilityConverterKey" />
    <SolidColorBrush x:Key="RibbonInnerBorderBrushKey" Color="#60FFFFFF" />
    <system:Double x:Key="RibbonHeight">91.0</system:Double>
    <LinearGradientBrush x:Key="RibbonOverlayBackgroundBrushKey" StartPoint="0.5,0.0" EndPoint="0.5,1.0">
        <GradientStop Offset="0.0" Color="#EEFFFFFF" />
        <GradientStop Offset="0.1" Color="#BBFFFFFF" />
        <GradientStop Offset="0.5" Color="#05FFFFFF" />
        <GradientStop Offset="1.0" Color="#20FFFFFF" />
    </LinearGradientBrush>
    <LinearGradientBrush x:Key="MouseOverBackgroundBrushKey" StartPoint="0,0" EndPoint="0,1">
        <GradientStop Offset="0" Color="#FFFEFBF4" />
        <GradientStop Offset="0.19" Color="#FFFDE7CE" />
        <GradientStop Offset="0.39" Color="#FFFDDEB8" />
        <GradientStop Offset="0.39" Color="#FFFFCE6B" />
        <GradientStop Offset="0.79" Color="#FFFFDE9A" />
        <GradientStop Offset="1" Color="#FFFFEBAA" />
    </LinearGradientBrush>
    <SolidColorBrush x:Key="MouseOverBorderBrushKey" Color="#FFFFB700" />
    <LinearGradientBrush x:Key="PressedBackgroundBrushKey" StartPoint="0,0" EndPoint="0,1">
        <GradientStop Offset="0" Color="#FFE3C085" />
        <GradientStop Offset="0.19" Color="#FFF4CC89" />
        <GradientStop Offset="0.36" Color="#FFF5C777" />
        <GradientStop Offset="0.36" Color="#FFF5BB56" />
        <GradientStop Offset="0.79" Color="#FFF4CE9A" />
        <GradientStop Offset="1" Color="#FFF3E28D" />
    </LinearGradientBrush>
    <SolidColorBrush x:Key="PressedBorderBrushKey" Color="#FFC29B29" />
    <LinearGradientBrush x:Key="CheckedBackgroundBrushKey" StartPoint="0,0" EndPoint="0,1">
        <GradientStop Offset="0" Color="#FFFFDCA0" />
        <GradientStop Offset="0.18" Color="#FFFFD692" />
        <GradientStop Offset="0.39" Color="#FFFFC45D" />
        <GradientStop Offset="1" Color="#FFFFD178" />
    </LinearGradientBrush>
    <SolidColorBrush x:Key="RibbonBorderBrushKey" Color="#B9C9DA" />
    <SolidColorBrush x:Key="RibbonBackgroundBrushKey" Color="#DFE9F5" />

    <DataTemplate x:Key="PlainRibbonString" DataType="{x:Type system:String}">
        <TextBlock
            x:Name="titleTextBlock"
            Margin="0,-2,0,0"
            HorizontalAlignment="{TemplateBinding HorizontalAlignment}"
            Text="{TemplateBinding Content}"
            TextTrimming="CharacterEllipsis" />
        <DataTemplate.Triggers>
            <MultiDataTrigger>
                <MultiDataTrigger.Conditions>
                    <Condition Binding="{Binding Path=(SystemParameters.IsGlassEnabled)}" Value="True" />
                    <Condition Binding="{Binding RelativeSource={RelativeSource Mode=FindAncestor, AncestorType=ribbon:Ribbon}, Path=IsHostedInRibbonWindow}" Value="True" />
                </MultiDataTrigger.Conditions>
                <Setter TargetName="titleTextBlock" Property="TextBlock.Effect">
                    <Setter.Value>
                        <DropShadowEffect
                            BlurRadius="5.0"
                            ShadowDepth="0"
                            Color="White" />
                    </Setter.Value>
                </Setter>
            </MultiDataTrigger>
            <DataTrigger Binding="{Binding Path=(SystemParameters.IsGlassEnabled)}" Value="False">
                <Setter TargetName="titleTextBlock" Property="Margin" Value="0" />
                <Setter TargetName="titleTextBlock" Property="VerticalAlignment" Value="Center" />
            </DataTrigger>
            <DataTrigger Binding="{Binding Path=(SystemParameters.HighContrast)}" Value="True">
                <Setter TargetName="titleTextBlock" Property="Margin" Value="0,1,0,0" />
            </DataTrigger>
            <!--  The Title is drawn slightly differently in AeroLite.  -->
            <MultiDataTrigger>
                <MultiDataTrigger.Conditions>
                    <Condition Binding="{Binding Path=(SystemParameters.UxThemeName)}" Value="AeroLite" />
                    <Condition Binding="{Binding Path=(SystemParameters.IsGlassEnabled)}" Value="False" />
                    <Condition Binding="{Binding RelativeSource={RelativeSource Mode=FindAncestor, AncestorType=ribbon:Ribbon}, Path=IsHostedInRibbonWindow}" Value="True" />
                    <Condition Binding="{Binding RelativeSource={RelativeSource Mode=FindAncestor, AncestorType=ribbon:RibbonWindow}, Path=WindowState}" Value="Normal" />
                </MultiDataTrigger.Conditions>
                <Setter TargetName="titleTextBlock" Property="Margin" Value="0,0,0,7" />
            </MultiDataTrigger>

        </DataTemplate.Triggers>
    </DataTemplate>


    <Style x:Key="PlainRibbonStyle" TargetType="{x:Type ribbon:Ribbon}">
        <!--<Style.Resources>
            <PopupAnimation x:Key="{x:Static SystemParameters.MenuPopupAnimationKey}">Fade</PopupAnimation>
        </Style.Resources>-->
        <Style.Triggers>
            <Trigger Property="componentModel:DesignerProperties.IsInDesignMode" Value="True">
                <Setter Property="Visibility" Value="Visible" />
            </Trigger>
            <Trigger Property="componentModel:DesignerProperties.IsInDesignMode" Value="False">
                <Setter Property="Visibility" Value="Collapsed" />
            </Trigger>
            <Trigger Property="Name" Value="MainRibbon">
                <Setter Property="Visibility" Value="Visible" />
            </Trigger>
        </Style.Triggers>
        <Setter Property="Visibility" Value="Collapsed" />
        <Setter Property="HorizontalContentAlignment" Value="Left" />
        <Setter Property="FocusVisualStyle" Value="{x:Null}" />
        <Setter Property="Background" Value="{StaticResource RibbonBackgroundBrushKey}" />
        <Setter Property="BorderBrush" Value="{StaticResource RibbonBorderBrushKey}" />
        <Setter Property="MouseOverBorderBrush" Value="{StaticResource MouseOverBorderBrushKey}" />
        <Setter Property="MouseOverBackground" Value="{StaticResource MouseOverBackgroundBrushKey}" />
        <Setter Property="PressedBorderBrush" Value="{StaticResource PressedBorderBrushKey}" />
        <Setter Property="PressedBackground" Value="{StaticResource PressedBackgroundBrushKey}" />
        <Setter Property="CheckedBorderBrush" Value="{StaticResource PressedBorderBrushKey}" />
        <Setter Property="CheckedBackground" Value="{StaticResource CheckedBackgroundBrushKey}" />
        <Setter Property="FocusedBorderBrush" Value="{StaticResource MouseOverBorderBrushKey}" />
        <Setter Property="FocusedBackground" Value="{StaticResource MouseOverBackgroundBrushKey}" />
        <Setter Property="FontSize" Value="{DynamicResource {x:Static SystemFonts.MenuFontSizeKey}}" />
        <Setter Property="FontStyle" Value="{DynamicResource {x:Static SystemFonts.MenuFontStyleKey}}" />
        <Setter Property="FontWeight" Value="{DynamicResource {x:Static SystemFonts.MenuFontWeightKey}}" />
        <Setter Property="FontFamily" Value="{DynamicResource {x:Static SystemFonts.MenuFontFamilyKey}}" />
        <Setter Property="Foreground" Value="{DynamicResource {x:Static SystemColors.MenuTextBrushKey}}" />
        <Setter Property="Template">
            <Setter.Value>

                <ControlTemplate TargetType="{x:Type ribbon:Ribbon}">

                    <Grid SnapsToDevicePixels="True">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition Width="*" />
                            <ColumnDefinition Width="Auto" />
                        </Grid.ColumnDefinitions>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                        </Grid.RowDefinitions>

                        <!--  Ribbon Background  -->
                        <Border
                            Name="BackgroundBorder"
                            Grid.Row="1"
                            Grid.RowSpan="3"
                            Grid.ColumnSpan="3"
                            Background="{TemplateBinding Background}"
                            BorderBrush="{TemplateBinding BorderBrush}" />

                        <!--  Popup hosting the groups when IsMinimized=true  -->
                        <Border Grid.Row="1" Grid.ColumnSpan="3">
                            <Popup
                                x:Name="PART_ITEMSPRESENTERPOPUP"
                                AllowsTransparency="True"
                                IsOpen="{Binding Path=IsDropDownOpen, RelativeSource={RelativeSource TemplatedParent}}"
                                PopupAnimation="{DynamicResource {x:Static SystemParameters.MenuPopupAnimationKey}}">
                                <classic:SystemDropShadowChrome
                                    Name="Shdw"
                                    Margin="0,0,5,5"
                                    FocusVisualStyle="{x:Null}"
                                    Focusable="True"
                                    RenderOptions.ClearTypeHint="Enabled"
                                    Color="Transparent">
                                    <Border Name="CollapsedPopupBackgroundBorder" Background="{TemplateBinding Background}">
                                        <ContentControl
                                            x:Name="popupItemsPresenterHost"
                                            Margin="0,1,0,0"
                                            Focusable="False"
                                            KeyboardNavigation.DirectionalNavigation="Cycle"
                                            KeyboardNavigation.TabNavigation="Cycle" />
                                    </Border>
                                </classic:SystemDropShadowChrome>
                            </Popup>
                        </Border>

                        <ContentControl
                            x:Name="mainItemsPresenterHost"
                            Grid.Row="2"
                            Grid.ColumnSpan="3"
                            Focusable="False">
                            <Border
                                x:Name="groupsBorder"
                                Height="{StaticResource RibbonHeight}"
                                Background="{StaticResource RibbonOverlayBackgroundBrushKey}"
                                BorderBrush="{TemplateBinding BorderBrush}"
                                BorderThickness="1,0,1,1"
                                SnapsToDevicePixels="True">
                                <Border
                                    Margin="0,0,0,1"
                                    BorderBrush="{StaticResource RibbonInnerBorderBrushKey}"
                                    BorderThickness="0,0,0,1"
                                    SnapsToDevicePixels="True">
                                    <ItemsPresenter Name="ItemsPresenter" />
                                </Border>
                            </Border>
                        </ContentControl>

                        <!--  QuickAccessToolbar bottom placeholder  -->
                        <Border
                            x:Name="QatBottomHost"
                            Grid.Row="3"
                            Grid.ColumnSpan="3"
                            BorderBrush="{TemplateBinding BorderBrush}">
                            <ContentPresenter
                                x:Name="QatBottomHostContentPresenter"
                                HorizontalAlignment="Left"
                                VerticalAlignment="Center"
                                IsHitTestVisible="True" />
                        </Border>

                        <!--  TitleBar  -->
                        <!--<Border
                Name="titleBarBackground"
                Grid.ColumnSpan="3"
                Background="{StaticResource RibbonOverlayBackgroundBrushKey}"
                BorderBrush="{TemplateBinding BorderBrush}"
                BorderThickness="0,0,0,1"
                Visibility="Collapsed" />

            <DockPanel
                Grid.Column="0"
                Grid.ColumnSpan="3"
                Height="{Binding Path=(SystemParameters.WindowCaptionHeight)}"
                LastChildFill="True">

                <ContentControl
                    x:Name="windowButtonPlaceHolder"
                    Width="{Binding Path=(SystemParameters.WindowCaptionButtonWidth)}"
                    Margin="3,0,0,0"
                    DockPanel.Dock="Right"
                    Focusable="False"
                    IsHitTestVisible="False"
                    Visibility="{TemplateBinding IsHostedInRibbonWindow,
                                                 Converter={StaticResource BooleanToVisibilityConverterKey}}" />
                <ContentControl
                    x:Name="windowIconPadding"
                    Width="{Binding Path=(SystemParameters.SmallIconWidth)}"
                    Margin="0,0,3,0"
                    DockPanel.Dock="Left"
                    Focusable="False"
                    IsHitTestVisible="False" />
                <primitives:RibbonTitlePanel x:Name="PART_TitlePanel">
                    <Grid x:Name="QatTopHost">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition Width="*" />
                            <ColumnDefinition Width="Auto" />
                        </Grid.ColumnDefinitions>

                        <Border
                            x:Name="QatTopHostLeftBorder"
                            Grid.Column="0"
                            Width="3"
                            Margin="8,2,0,2"
                            Background="#77222222"
                            BorderBrush="#66CCCCCC"
                            BorderThickness="1,0,1,0.9"
                            CornerRadius="0,0,2,2" />

                        <ContentPresenter
                            x:Name="QatTopHostContentPresenter"
                            Grid.Column="1"
                            Content="{TemplateBinding QuickAccessToolBar}"
                            IsHitTestVisible="True" />

                        <Border
                            x:Name="QatTopHostRightBorder"
                            Grid.Column="2"
                            Width="3"
                            Margin="0,2,1,2"
                            Background="#77222222"
                            BorderBrush="#66CCCCCC"
                            BorderThickness="1,0,1,0.9"
                            CornerRadius="0,0,2,2" />

                    </Grid>
                    <ContentPresenter
                        x:Name="PART_TitleHost"
                        MinWidth="75"
                        MinHeight="{Binding Path=(SystemParameters.WindowCaptionHeight)}"
                        Margin="3,0"
                        HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"
                        ContentSource="Title"
                        ContentTemplate="{TemplateBinding TitleTemplate}"
                        IsHitTestVisible="False"
                        TextBlock.FontFamily="{DynamicResource {x:Static SystemFonts.CaptionFontFamilyKey}}"
                        TextBlock.FontSize="{DynamicResource {x:Static SystemFonts.CaptionFontSizeKey}}"
                        TextBlock.FontWeight="{DynamicResource {x:Static SystemFonts.CaptionFontWeightKey}}"
                        TextElement.Foreground="{DynamicResource {x:Static SystemColors.ActiveCaptionTextBrushKey}}">
                        <ContentPresenter.Resources>

                        </ContentPresenter.Resources>
                    </ContentPresenter>
                    <ribbon:RibbonContextualTabGroupItemsControl
                        x:Name="PART_ContextualTabGroupItemsControl"
                        HorizontalAlignment="Center"
                        shell:WindowChrome.IsHitTestVisibleInChrome="True"
                        IsHitTestVisible="True" />
                </primitives:RibbonTitlePanel>
            </DockPanel>-->

                        <!--  Application Menu  -->
                        <!--<ContentPresenter
                            x:Name="applicationMenu"
                            Grid.Row="1"
                            VerticalAlignment="Top"
                            Content="{TemplateBinding ApplicationMenu}" />-->

                        <ribbon:RibbonTabHeaderItemsControl
                            x:Name="TabHeaderItemsControl"
                            Grid.Row="1"
                            Grid.Column="1"
                            Margin="1,1,1,0"
                            HorizontalAlignment="Left"
                            VerticalAlignment="Top" />

                        <!--  HelpPane appears to the right of TabsPanel  -->
                        <!--<ContentPresenter
                            x:Name="PART_HelpPane"
                            Grid.Row="1"
                            Grid.Column="2"
                            HorizontalAlignment="Right"
                            VerticalAlignment="Top"
                            ContentSource="HelpPaneContent"
                            ContentTemplate="{TemplateBinding HelpPaneContentTemplate}" />-->

                    </Grid>

                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

</ResourceDictionary>