<ResourceDictionary
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:classic="clr-namespace:Microsoft.Windows.Themes;assembly=PresentationFramework.Aero"
    xmlns:componentModel="clr-namespace:System.ComponentModel;assembly=PresentationFramework"
    xmlns:controls="clr-namespace:System.Windows.Controls;assembly=System.Windows.Controls.Ribbon"
    xmlns:entities="clr-namespace:EPIC.DataLayer.Entities;assembly=DataLayer"
    xmlns:primitives="clr-namespace:System.Windows.Controls.Ribbon.Primitives;assembly=System.Windows.Controls.Ribbon"
    xmlns:ribbon="clr-namespace:System.Windows.Controls.Ribbon;assembly=System.Windows.Controls.Ribbon"
    xmlns:shell="clr-namespace:System.Windows.Shell;assembly=PresentationFramework"
    xmlns:system="clr-namespace:System;assembly=mscorlib">

    <ControlTemplate x:Key="PlainRibbonTabStyle" TargetType="{x:Type ribbon:RibbonTab}">
        <Grid
            x:Name="MainGrid"
            ClipToBounds="True"
            Visibility="{TemplateBinding IsSelected,
                                         Converter={StaticResource BooleanToVisibilityConverterKey}}">
            <Line
                x:Name="OuterLeftLine"
                Stroke="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=ContextualTabGroup.Background}"
                StrokeThickness="2"
                X1="0"
                X2="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=TabHeaderLeft}"
                Y1="0"
                Y2="0" />
            <Line
                x:Name="OuterRightLine"
                Stroke="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=ContextualTabGroup.Background}"
                StrokeThickness="2"
                X1="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=TabHeaderRight}"
                X2="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=ActualWidth}"
                Y1="0"
                Y2="0" />
            <ScrollViewer x:Name="ScrollViewer" Style="{StaticResource RibbonTabScrollViewer}">
                <Grid RenderOptions.ClearTypeHint="Enabled">
                    <Canvas
                        x:Name="BackgroundCanvas"
                        Width="0"
                        Height="0"
                        Margin="0,1,0,0"
                        HorizontalAlignment="Left"
                        VerticalAlignment="Top">
                        <Rectangle
                            x:Name="OpaqueRect"
                            Width="{Binding ElementName=ScrollViewer, Path=ActualWidth}"
                            Height="{Binding ElementName=ScrollViewer, Path=ActualHeight}"
                            Fill="{Binding RelativeSource={RelativeSource Self}, Path=(ribbon:RibbonControlService.Ribbon).Background}" />
                        <Rectangle
                            x:Name="OverlayRect"
                            Width="{Binding ElementName=ScrollViewer, Path=ActualWidth}"
                            Height="{Binding ElementName=ScrollViewer, Path=ActualHeight}"
                            Fill="{StaticResource RibbonOverlayBackgroundBrushKey}" />
                        <Rectangle
                            x:Name="InnerOverlayRect"
                            Width="{Binding ElementName=ScrollViewer, Path=ActualWidth}"
                            Height="{Binding ElementName=ScrollViewer, Path=ActualHeight}"
                            Fill="{StaticResource RibbonInnerBorderBrushKey}" />
                    </Canvas>
                    <ItemsPresenter x:Name="ItemsPresenter" />
                </Grid>
            </ScrollViewer>
        </Grid>
    </ControlTemplate>
    <ControlTemplate x:Key="EncapsulatedRibbonTabStyle">
        <ribbon:Ribbon Margin="0,-120,0,0" Style="{StaticResource PlainRibbonStyle}">
            <ItemsPresenter />
        </ribbon:Ribbon>
    </ControlTemplate>
    <Style x:Key="DesignTimeRibbonStyle" TargetType="{x:Type RibbonTab}">
        <Style.Triggers>
            <Trigger Property="componentModel:DesignerProperties.IsInDesignMode" Value="True">
                <Setter Property="Template" Value="{StaticResource EncapsulatedRibbonTabStyle}" />
            </Trigger>
        </Style.Triggers>
        <Setter Property="Template" Value="{StaticResource PlainRibbonTabStyle}" />

    </Style>
    <Style x:Key="ContextualHeaderStyle" TargetType="{x:Type ribbon:RibbonTabHeader}">
        <Setter Property="ContentTemplate">
            <Setter.Value>
                <DataTemplate>
                    <TextBlock
                        Margin="-10,-10,-10,0"
                        Padding="10,10,10,0"
                        Text="{Binding}">
                        <TextBlock.Background>
                            <LinearGradientBrush StartPoint="0.5,0" EndPoint="0.5,1">
                                <LinearGradientBrush.GradientStops>
                                    <GradientStop Offset="0" Color="#AAFFFF00" />
                                    <GradientStop Offset="1" Color="#00FFFF00" />
                                </LinearGradientBrush.GradientStops>
                            </LinearGradientBrush>
                        </TextBlock.Background>
                    </TextBlock>
                </DataTemplate>
            </Setter.Value>
        </Setter>

    </Style>
    <Style x:Key="ContextualTabStyle" TargetType="{x:Type ribbon:RibbonTab}">
        <Setter Property="IsSelected" Value="True" />
        <Setter Property="HeaderStyle" Value="{StaticResource ContextualHeaderStyle}" />
    </Style>


</ResourceDictionary>
