<ResourceDictionary
    x:Class="EPIC.MedicalControls.Controls.Patient.Add"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:entities="clr-namespace:EPIC.DataLayer.Entities;assembly=DataLayer"
    xmlns:general="clr-namespace:EPIC.MedicalControls.Themes"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:ribbon="clr-namespace:System.Windows.Controls.Ribbon;assembly=System.Windows.Controls.Ribbon"
    xmlns:system="clr-namespace:System;assembly=mscorlib"
    mc:Ignorable="d">
    <ItemsPanelTemplate x:Key="UserEntityPanelTemplate">
        <Grid>
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*" />
                <ColumnDefinition Width="Auto" />
                <ColumnDefinition Width="*" />
            </Grid.ColumnDefinitions>
            <Grid.RowDefinitions>
                <RowDefinition />
                <RowDefinition />
            </Grid.RowDefinitions>
        </Grid>
    </ItemsPanelTemplate>

    <DataTemplate x:Key="PlainTextFieldTemplate" DataType="{x:Type general:PropertyMetadata}">
        <StackPanel Name="ControlWrapper">
            <Label Content="{Binding DisplayName}" FontWeight="Bold" />
            <TextBox
                Name="PropertyName"
                MaxLength="{Binding MaxLength}"
                Text="{Binding Value}" />
        </StackPanel>
    </DataTemplate>
    <DataTemplate x:Key="DefaultFieldTemplate" DataType="{x:Type general:PropertyMetadata}">
        <StackPanel Name="ControlWrapper">
            <Label Content="{Binding Name}" Foreground="Gray" />
            <Label Content="{Binding PropertyType}" Foreground="Gray" />
        </StackPanel>
    </DataTemplate>

    <DataTemplate x:Key="UserEntityItemTemplate" DataType="{x:Type general:PropertyMetadata}">
        <ContentPresenter
            x:Name="Presenter"
            MaxWidth="Infinity"
            Margin="5"
            ContentTemplate="{StaticResource DefaultFieldTemplate}" />

        <DataTemplate.Triggers>
            <DataTrigger Binding="{Binding Name}" Value="MiddleInitial">
                <Setter TargetName="Presenter" Property="MaxWidth" Value="100" />
            </DataTrigger>
            <DataTrigger Binding="{Binding PropertyType}" Value="{x:Type system:String}">
                <Setter TargetName="Presenter" Property="ContentTemplate" Value="{StaticResource PlainTextFieldTemplate}" />
            </DataTrigger>
        </DataTemplate.Triggers>
    </DataTemplate>


    <Style x:Key="UserItemsGridStyle" TargetType="ContentPresenter">
        <Setter Property="Grid.Column" Value="0" />

        <Style.Triggers>
            <DataTrigger Binding="{Binding Order}" Value="3">
                <Setter Property="Grid.Row" Value="1" />
            </DataTrigger>
            <DataTrigger Binding="{Binding Order}" Value="4">
                <Setter Property="Grid.Column" Value="1" />
                <Setter Property="Grid.Row" Value="1" />
            </DataTrigger>
            <DataTrigger Binding="{Binding Order}" Value="5">
                <Setter Property="Grid.Column" Value="2" />
                <Setter Property="Grid.Row" Value="1" />
            </DataTrigger>
            <DataTrigger Binding="{Binding Name}" Value="MiddleInitial">
                <Setter Property="Grid.Column" Value="1" />
            </DataTrigger>
            <DataTrigger Binding="{Binding Name}" Value="LastName">
                <Setter Property="Grid.Column" Value="2" />
            </DataTrigger>
        </Style.Triggers>
    </Style>

    <Style x:Key="PlainEntityStyle" TargetType="{x:Type ItemsControl}">
        <Style.Triggers>
            <DataTrigger Binding="{Binding RelativeSource={RelativeSource Self}, Path=Items.Count}" Value="0">
                <Setter Property="Visibility" Value="Collapsed" />
            </DataTrigger>
        </Style.Triggers>
    </Style>

    <Style
        x:Key="PatientEntityStyle"
        BasedOn="{StaticResource PlainEntityStyle}"
        TargetType="{x:Type ItemsControl}">
        <Setter Property="ItemsSource" Value="{Binding DataContext}" />
        <Setter Property="ItemsPanel" Value="{StaticResource UserEntityPanelTemplate}" />

        <Setter Property="ItemContainerStyle" Value="{StaticResource UserItemsGridStyle}" />
        <Setter Property="ItemTemplate" Value="{StaticResource UserEntityItemTemplate}" />
    </Style>

</ResourceDictionary>
